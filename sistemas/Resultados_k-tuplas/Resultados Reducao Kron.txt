>> H
H=
      X2    X3    X4     X5    X6
I1    -1    -1     0     0     0
I3    -1     3    -1     0     0
I5     0     0    -1     1     0
I6     0     0    -1     0     1
F1    -1     0     0     0     0
F2     1    -1     0     0     0
F3     0     0     1    -1     0
F5     0     0     1     0    -1
F4     0     0    -1     1     0

>> H*H'
ans =
      I1    I3     I5   I6     F1    F2    F3    F5    F6
I1     2    -2     0     0     1     0     0     0     0
I3    -2    11     1     1     1    -4    -1    -1     1
I5     0     1     2     1     0     0    -2    -1     2
I6     0     1     1     2     0     0    -1    -2     1
F1     1     1     0     0     1    -1     0     0     0
F2     0    -4     0     0    -1     2     0     0     0
F3     0    -1    -2    -1     0     0     2     1    -2
F5     0    -1    -1    -2     0     0     1     2    -1
F6     0     1     2     1     0     0    -2    -1     2

>> X=node_elimination(H*H',[2])
X =

    1.6364    0.1818    0.1818    1.1818   -0.7273   -0.1818   -0.1818    0.1818
    0.1818    1.9091    0.9091   -0.0909    0.3636   -1.9091   -0.9091    1.9091
    0.1818    0.9091    1.9091   -0.0909    0.3636   -0.9091   -1.9091    0.9091
    1.1818   -0.0909   -0.0909    0.9091   -0.6364    0.0909    0.0909   -0.0909
   -0.7273    0.3636    0.3636   -0.6364    0.5455   -0.3636   -0.3636    0.3636
   -0.1818   -1.9091   -0.9091    0.0909   -0.3636    1.9091    0.9091   -1.9091
   -0.1818   -0.9091   -1.9091    0.0909   -0.3636    0.9091    1.9091   -0.9091
    0.1818    1.9091    0.9091   -0.0909    0.3636   -1.9091   -0.9091    1.9091

>> X=node_elimination(H*H',[1 5])
X =

     1     1     1     0    -1    -1     1
     1     2     1     0    -2    -1     2
     1     1     2     0    -1    -2     1
     0     0     0     0     0     0     0
    -1    -2    -1     0     2     1    -2
    -1    -1    -2     0     1     2    -1
     1     2     1     0    -2    -1     2

>> X=node_elimination(H*H',[5 6])
X =

     0     0     0     0     0     0     0
     0     1     1     1    -1    -1     1
     0     1     2     1    -2    -1     2
     0     1     1     2    -1    -2     1
     0    -1    -2    -1     2     1    -2
     0    -1    -1    -2     1     2    -1
     0     1     2     1    -2    -1     2

>> X=node_elimination(H*H',[9])
X =

    2.0000   -2.0000         0         0    1.0000         0         0         0
   -2.0000   10.5000         0    0.5000    1.0000   -4.0000         0   -0.5000
         0         0         0         0         0         0         0         0
         0    0.5000         0    1.5000         0         0         0   -1.5000
    1.0000    1.0000         0         0    1.0000   -1.0000         0         0
         0   -4.0000         0         0   -1.0000    2.0000         0         0
         0         0         0         0         0         0         0         0
         0   -0.5000         0   -1.5000         0         0         0    1.5000

>> X=node_elimination(H*H',[3])
X =

    2.0000   -2.0000         0    1.0000         0         0         0         0
   -2.0000   10.5000    0.5000    1.0000   -4.0000         0   -0.5000         0
         0    0.5000    1.5000         0         0         0   -1.5000         0
    1.0000    1.0000         0    1.0000   -1.0000         0         0         0
         0   -4.0000         0   -1.0000    2.0000         0         0         0
         0         0         0         0         0         0         0         0
         0   -0.5000   -1.5000         0         0         0    1.5000         0
         0         0         0         0         0         0         0         0

>> [X,Y,A,B,C,D]=node_elimination(H*H',[2])
X =

    1.6364    0.1818    0.1818    1.1818   -0.7273   -0.1818   -0.1818    0.1818
    0.1818    1.9091    0.9091   -0.0909    0.3636   -1.9091   -0.9091    1.9091
    0.1818    0.9091    1.9091   -0.0909    0.3636   -0.9091   -1.9091    0.9091
    1.1818   -0.0909   -0.0909    0.9091   -0.6364    0.0909    0.0909   -0.0909
   -0.7273    0.3636    0.3636   -0.6364    0.5455   -0.3636   -0.3636    0.3636
   -0.1818   -1.9091   -0.9091    0.0909   -0.3636    1.9091    0.9091   -1.9091
   -0.1818   -0.9091   -1.9091    0.0909   -0.3636    0.9091    1.9091   -0.9091
    0.1818    1.9091    0.9091   -0.0909    0.3636   -1.9091   -0.9091    1.9091


Y =

     2    -2     0     0     1     0     0     0     0
    -2    11     1     1     1    -4    -1    -1     1
     0     1     2     1     0     0    -2    -1     2
     0     1     1     2     0     0    -1    -2     1
     1     1     0     0     1    -1     0     0     0
     0    -4     0     0    -1     2     0     0     0
     0    -1    -2    -1     0     0     2     1    -2
     0    -1    -1    -2     0     0     1     2    -1
     0     1     2     1     0     0    -2    -1     2

>> [X,Y,A,B,C,D]=node_elimination(Y,[1])
X =

    9.0000    1.0000    1.0000    2.0000   -4.0000   -1.0000   -1.0000    1.0000
    1.0000    2.0000    1.0000         0         0   -2.0000   -1.0000    2.0000
    1.0000    1.0000    2.0000         0         0   -1.0000   -2.0000    1.0000
    2.0000         0         0    0.5000   -1.0000         0         0         0
   -4.0000         0         0   -1.0000    2.0000         0         0         0
   -1.0000   -2.0000   -1.0000         0         0    2.0000    1.0000   -2.0000
   -1.0000   -1.0000   -2.0000         0         0    1.0000    2.0000   -1.0000
    1.0000    2.0000    1.0000         0         0   -2.0000   -1.0000    2.0000


Y =

     2    -2     0     0     1     0     0     0     0
    -2    11     1     1     1    -4    -1    -1     1
     0     1     2     1     0     0    -2    -1     2
     0     1     1     2     0     0    -1    -2     1
     1     1     0     0     1    -1     0     0     0
     0    -4     0     0    -1     2     0     0     0
     0    -1    -2    -1     0     0     2     1    -2
     0    -1    -1    -2     0     0     1     2    -1
     0     1     2     1     0     0    -2    -1     2


>> [X,Y,A,B,C,D]=node_elimination(Y,[4])

X =

    2.0000   -2.0000         0    1.0000         0         0         0         0
   -2.0000   10.5000    0.5000    1.0000   -4.0000   -0.5000         0    0.5000
         0    0.5000    1.5000         0         0   -1.5000         0    1.5000
    1.0000    1.0000         0    1.0000   -1.0000         0         0         0
         0   -4.0000         0   -1.0000    2.0000         0         0         0
         0   -0.5000   -1.5000         0         0    1.5000         0   -1.5000
         0         0         0         0         0         0         0         0
         0    0.5000    1.5000         0         0   -1.5000         0    1.5000


Y =

     2    -2     0     0     1     0     0     0     0
    -2    11     1     1     1    -4    -1    -1     1
     0     1     2     1     0     0    -2    -1     2
     0     1     1     2     0     0    -1    -2     1
     1     1     0     0     1    -1     0     0     0
     0    -4     0     0    -1     2     0     0     0
     0    -1    -2    -1     0     0     2     1    -2
     0    -1    -1    -2     0     0     1     2    -1
     0     1     2     1     0     0    -2    -1     2